{% schema %}
    {
      "name": "Image Slider",
      "settings": [
        {
          "type": "range",
          "id": "autoplay_speed",
          "label": "Autoplay speed (ms)",
          "default": 3000,
          "min": 1000,
          "max": 10000,
          "step": 500
        },
        {
          "type": "range",
          "id": "padding_x",
          "label": "Horizontal Padding (Desktop)",
          "default": 80,
          "min": 0,
          "max": 200,
          "step": 4
        },
        {
          "type": "range",
          "id": "padding_y",
          "label": "Vertical Padding",
          "default": 0,
          "min": 0,
          "max": 100,
          "step": 4
        }
      ],
      "blocks": [
        {
          "type": "slide",
          "name": "Slide",
          "settings": [
            {
              "type": "image_picker",
              "id": "image",
              "label": "Slide Image"
            },
            {
              "type": "url",
              "id": "link",
              "label": "Slide Link"
            }
          ]
        }
      ],
      "presets": [
        {
          "name": "Image Slider",
          "category": "Custom"
        }
      ]
    }
    {% endschema %}
    
    <section class="slider-section" style="padding: {{ section.settings.padding_y }}px {{ section.settings.padding_x }}px;">
      <div class="slider-wrapper relative overflow-hidden">
        <div class="slider-track flex transition-all duration-500">
          {% for block in section.blocks %}
            {% if block.settings.image %}
              <div class="slide min-w-full flex-shrink-0">
                <a href="{{ block.settings.link | default: '#' }}">
                  <img
                    src="{{ block.settings.image | image_url: width: 2000 }}"
                    width="{{ block.settings.image.width }}"
                    height="{{ block.settings.image.height }}"
                    alt="{{ block.settings.image.alt | escape }}"
                    loading="lazy"
                  >
                </a>
              </div>
            {% endif %}
          {% endfor %}
        </div>
        <div class="slider-dots text-center mt-4">
          {% for block in section.blocks %}
            <span class="dot{% if forloop.first %} active{% endif %}" data-index="{{ forloop.index0 }}"></span>
          {% endfor %}
        </div>
        <!-- Arrows -->
        <button id="prev" class="slider-arrow left">
          <img src="//cdn.shopify.com/s/files/1/0680/4150/7113/t/199/assets/icon-arrow-nav.svg" width="11" height="18">
        </button>
        <button id="next" class="slider-arrow right">
          <img src="//cdn.shopify.com/s/files/1/0680/4150/7113/t/199/assets/icon-arrow-nav.svg" class="rotate-180" width="11" height="18">
        </button>
      </div>
    </section>
    
    <style>
      .slider-section {
        max-width: 100%;
      }
      .slider-track {
        display: flex;
        transition: transform 0.5s ease-in-out;
      }
      .slide img {
        width: 100%;
        height: auto;
        object-fit: cover;
        display: block;
      }
      .slider-dots .dot {
        width: 6px;
        height: 6px;
        background-color: #bbb;
        border-radius: 9999px;
        display: inline-block;
        margin: 0 4px;
        transition: all 0.3s ease;
      }
      .slider-dots .dot.active {
        width: 12px;
        background-color: #242faa;
      }
      .slider-arrow {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 44px;
        height: 44px;
        border-radius: 8px;
        background: white;
        display: none;
        justify-content: center;
        align-items: center;
        box-shadow: 0 4px 4px rgba(36, 47, 102, .15);
        backdrop-filter: blur(8px);
        z-index: 10;
      }
      .slider-arrow.left { left: 3.5%; }
      .slider-arrow.right { right: 3.5%; }
      @media(min-width: 1024px) {
        .slider-arrow { display: flex; }
      }
    </style>
    
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const track = document.querySelector('.slider-track');
        const slides = document.querySelectorAll('.slide');
        const dots = document.querySelectorAll('.dot');
        const prev = document.getElementById('prev');
        const next = document.getElementById('next');
        let index = 0;
        const slideInterval = {{ section.settings.autoplay_speed }};
    
        function showSlide(i) {
          index = (i + slides.length) % slides.length;
          track.style.transform = `translateX(-${index * 100}%)`;
          dots.forEach(dot => dot.classList.remove('active'));
          dots[index].classList.add('active');
        }
    
        function nextSlide() { showSlide(index + 1); }
        function prevSlide() { showSlide(index - 1); }
    
        next?.addEventListener('click', nextSlide);
        prev?.addEventListener('click', prevSlide);
        dots.forEach((dot, i) => {
          dot.addEventListener('click', () => showSlide(i));
        });
    
        let autoSlide = setInterval(nextSlide, slideInterval);
      });
    </script>
    