{% schema %}
    {
      "name": "Image Slider with Dots",
      "settings": [
        {
          "type": "range",
          "id": "autoplay_interval",
          "label": "Autoplay interval (seconds)",
          "min": 1,
          "max": 10,
          "step": 1,
          "default": 3
        },
        {
          "type": "range",
          "id": "padding_top",
          "label": "Padding Top (px)",
          "min": 0,
          "max": 100,
          "step": 4,
          "default": 24
        },
        {
          "type": "range",
          "id": "padding_bottom",
          "label": "Padding Bottom (px)",
          "min": 0,
          "max": 100,
          "step": 4,
          "default": 24
        },
        {
          "type": "range",
          "id": "padding_left",
          "label": "Padding Left (px)",
          "min": 0,
          "max": 100,
          "step": 4,
          "default": 16
        },
        {
          "type": "range",
          "id": "padding_right",
          "label": "Padding Right (px)",
          "min": 0,
          "max": 100,
          "step": 4,
          "default": 16
        }
      ],
      "blocks": [
        {
          "type": "slide",
          "name": "Slide",
          "settings": [
            {
              "type": "image_picker",
              "id": "image",
              "label": "Image"
            },
            {
              "type": "url",
              "id": "link",
              "label": "Link URL"
            }
          ]
        }
      ],
      "presets": [
        {
          "name": "Image Slider with Dots"
        }
      ]
    }
    {% endschema %}
    
    <section class="image-slider-section relative" style="
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
      padding-left: {{ section.settings.padding_left }}px;
      padding-right: {{ section.settings.padding_right }}px;">
    
      <div class="slider-wrapper relative overflow-hidden lg:px-20">
        <div class="slider-track flex transition-all duration-500">
          {% for block in section.blocks %}
            {% if block.settings.image %}
              <div class="slide min-w-full flex-shrink-0">
                <a href="{{ block.settings.link | default: '#' }}">
                    <img
                    src="{{ block.settings.image | img_url: 'master' }}"
                    width="{{ block.settings.image.width }}"
                    height="{{ block.settings.image.height }}"
                    alt="{{ block.settings.image.alt | escape }}"
                    loading="lazy"
                    class="w-full h-auto object-cover"
                  />
                  
                </a>
              </div>
            {% endif %}
          {% endfor %}
        </div>
    
        <!-- Navigation Buttons -->
        <button id="prev" class="slider-nav-button prev hidden lg:flex">
          <img src="//nobero.com/cdn/shop/t/199/assets/icon-arrow-nav.svg" width="11" height="18" alt="Prev">
        </button>
        <button id="next" class="slider-nav-button next hidden lg:flex">
          <img class="rotate-180" src="//nobero.com/cdn/shop/t/199/assets/icon-arrow-nav.svg" width="11" height="18" alt="Next">
        </button>
    
        <!-- Dots -->
        <div class="slider-dots text-center mt-3">
          {% for block in section.blocks %}
            <span class="dot{% if forloop.first %} active{% endif %}" data-index="{{ forloop.index0 }}"></span>
          {% endfor %}
        </div>
      </div>
    </section>
    
    <style>
      .slider-nav-button {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 44px;
        height: 44px;
        background-color: white;
        border-radius: 6px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        z-index: 20;
        box-shadow: 0 4px 4px rgba(36, 47, 102, 0.15);
        backdrop-filter: blur(8px);
      }
    
      .slider-nav-button.prev {
        left: 3.5%;
      }
    
      .slider-nav-button.next {
        right: 3.5%;
      }
    
      .dot {
        width: 6px;
        height: 4px;
        background-color: #bbb;
        cursor: pointer;
        border-radius: 9999px;
        display: inline-block;
        margin: 0 4px;
        transition: all 0.3s ease;
      }
    
      .dot.active {
        width: 12px;
        background-color: #242faa;
      }
    </style>
    
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const sliderTrack = document.querySelector(".slider-track");
        const dots = document.querySelectorAll(".dot");
        const slides = document.querySelectorAll(".slide");
        const totalSlides = slides.length;
        let currentIndex = 0;
        const interval = {{ section.settings.autoplay_interval | times: 1000 }};
    
        function goToSlide(index) {
          sliderTrack.style.transform = `translateX(-${index * 100}%)`;
          dots.forEach(dot => dot.classList.remove("active"));
          if (dots[index]) dots[index].classList.add("active");
        }
    
        dots.forEach((dot, index) => {
          dot.addEventListener("click", () => {
            currentIndex = index;
            goToSlide(index);
          });
        });
    
        document.getElementById("prev")?.addEventListener("click", () => {
          currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
          goToSlide(currentIndex);
        });
    
        document.getElementById("next")?.addEventListener("click", () => {
          currentIndex = (currentIndex + 1) % totalSlides;
          goToSlide(currentIndex);
        });
    
        setInterval(() => {
          currentIndex = (currentIndex + 1) % totalSlides;
          goToSlide(currentIndex);
        }, interval);
      });
    </script>
    